author: lmori
description: Library of prototypes for commonly used nodes

prototypes:
    aggregatorURL:
        development_status: STABLE
        node_type: processor
        description: >
            Aggregator for URL indicators.
            Inputs with names starting with "wl" will be interpreted as
            whitelists.
        class: minemeld.ft.op.AggregateFT
        config:
            whitelist_prefixes:
                - wl
            infilters:
                - name: accept withdraws
                  conditions:
                    - __method == 'withdraw'
                  actions:
                    - accept
                - name: accept URL
                  conditions:
                    - type == 'URL'
                  actions:
                    - accept
                - name: drop all
                  actions:
                    - drop

    aggregatorDomain:
        development_status: STABLE
        node_type: processor
        description: >
            Aggregator for domain indicators.
            Inputs with names starting with "wl" will be interpreted as
            whitelists.
        class: minemeld.ft.op.AggregateFT
        config:
            whitelist_prefixes:
                - wl
            infilters:
                - name: accept withdraws
                  conditions:
                    - __method == 'withdraw'
                  actions:
                    - accept
                - name: accept domain
                  conditions:
                    - type == 'domain'
                  actions:
                    - accept
                - name: drop all
                  actions:
                    - drop

    aggregatorIPv4Generic:
        development_status: STABLE
        node_type: processor
        description: >
            Generic Aggregator for IPv4 indicators.
            Inputs with names starting with "wl" will be interpreted as
            whitelists.
        class: minemeld.ft.ipop.AggregateIPv4FT
        config:
            whitelist_prefixes:
                - wl
            infilters:
                - name: accept withdraws
                  conditions:
                    - __method == 'withdraw'
                  actions:
                    - accept
                - name: accept IPv4
                  conditions:
                    - type == 'IPv4'
                  actions:
                    - accept
                - name: drop all
                  actions:
                    - drop

    aggregatorIPv4Inbound:
        development_status: STABLE
        node_type: processor
        description: >
            Aggregator for inbound IPv4 indicators.
            Inputs with names starting with "wl" will be interpreted as
            whitelists.
        class: minemeld.ft.ipop.AggregateIPv4FT
        config:
            whitelist_prefixes:
                - wl
            infilters:
                - name: accept withdraws
                  conditions:
                    - __method == 'withdraw'
                  actions:
                    - accept
                - name: accept inbound IPv4
                  conditions:
                    - type == 'IPv4'
                    - direction == 'inbound'
                  actions:
                    - accept
                - name: accept generic IPv4
                  conditions:
                    - type == 'IPv4'
                    - direction == null
                  actions:
                    - accept
                - name: drop all
                  actions:
                    - drop

    aggregatorIPv4Outbound:
        development_status: STABLE
        node_type: processor
        description: >
            Aggregator for outbound IPv4 indicators.
            Inputs with names starting with "wl" will be interpreted as
            whitelists.
        class: minemeld.ft.ipop.AggregateIPv4FT
        config:
            whitelist_prefixes:
                - wl
            infilters:
                - name: accept withdraws
                  conditions:
                    - __method == 'withdraw'
                  actions:
                    - accept
                - name: accept inbound IPv4
                  conditions:
                    - type == 'IPv4'
                    - direction == 'outbound'
                  actions:
                    - accept
                - name: accept generic IPv4
                  conditions:
                    - type == 'IPv4'
                    - direction == null
                  actions:
                    - accept
                - name: drop all
                  actions:
                    - drop

    feedLCGreen:
        development_status: STABLE
        node_type: output
        description: >
            EBL for low confidence indicators (<50) and share level green
        class: minemeld.ft.redis.RedisSet
        config:
            infilters:
                - name: accept withdraws
                  conditions:
                    - __method == 'withdraw'
                  actions:
                    - accept
                - name: accept confidence < 50 and share level green
                  conditions:
                    - confidence < 50
                    - share_level == 'green'
                  actions:
                    - accept
                - name: drop all
                  actions:
                    - drop

    feedMCGreen:
        development_status: STABLE
        node_type: output
        description: >
            EBL for medium confidence indicators (>=50,<75) and share level green
        class: minemeld.ft.redis.RedisSet
        config:
            infilters:
                - name: accept withdraws
                  conditions:
                    - __method == 'withdraw'
                  actions:
                    - accept
                - name: accept confidence < 50 and share level green
                  conditions:
                    - confidence >= 50
                    - confidence < 75
                    - share_level == 'green'
                  actions:
                    - accept
                - name: drop all
                  actions:
                    - drop

    feedHCGreen:
        development_status: STABLE
        node_type: output
        description: >
            EBL for high confidence indicators (>75) and share level green, with value
        class: minemeld.ft.redis.RedisSet
        config:
            infilters:
                - name: accept withdraws
                  conditions:
                    - __method == 'withdraw'
                  actions:
                    - accept
                - name: accept confidence > 75 and share level green
                  conditions:
                    - confidence > 75
                    - share_level == 'green'
                  actions:
                    - accept
                - name: drop all
                  actions:
                    - drop

    feedLCGreenWithValue:
        development_status: STABLE
        node_type: output
        description: >
            EBL for low confidence indicators (<50) and share level green, with value
        class: minemeld.ft.redis.RedisSet
        config:
            store_value: true
            infilters:
                - name: accept withdraws
                  conditions:
                    - __method == 'withdraw'
                  actions:
                    - accept
                - name: accept confidence < 50 and share level green
                  conditions:
                    - confidence < 50
                    - share_level == 'green'
                  actions:
                    - accept
                - name: drop all
                  actions:
                    - drop

    feedMCGreenWithValue:
        development_status: STABLE
        node_type: output
        description: >
            EBL for medium confidence indicators (>=50,<75) and share level green, with value
        class: minemeld.ft.redis.RedisSet
        config:
            store_value: true
            infilters:
                - name: accept withdraws
                  conditions:
                    - __method == 'withdraw'
                  actions:
                    - accept
                - name: accept confidence < 50 and share level green
                  conditions:
                    - confidence >= 50
                    - confidence < 75
                    - share_level == 'green'
                  actions:
                    - accept
                - name: drop all
                  actions:
                    - drop

    feedHCGreenWithValue:
        development_status: STABLE
        node_type: output
        description: >
            EBL for high confidence indicators (>75) and share level green, with value
        class: minemeld.ft.redis.RedisSet
        config:
            store_value: true
            infilters:
                - name: accept withdraws
                  conditions:
                    - __method == 'withdraw'
                  actions:
                    - accept
                - name: accept confidence > 75 and share level green
                  conditions:
                    - confidence > 75
                    - share_level == 'green'
                  actions:
                    - accept
                - name: drop all
                  actions:
                    - drop

    localSyslog:
        development_status: STABLE
        node_type: processor
        description: >
            Syslog node connection to the local syslog server to receive PAN-OS logs
        class: minemeld.ft.syslog.SyslogMatcher

    localSyslogToLogStash:
        development_status: EXPERIMENTAL
        node_type: processor
        description: >
            Syslog node connection to the local syslog server to receive PAN-OS logs.
            This prototype also logs matching sessions/indicators pairs to a Logstash
            instance on localhost:5514
        class: minemeld.ft.syslog.SyslogMatcher
        config:
            logstash_host: 127.0.0.1
            logstash_port: 5514

    localLogStash:
        development_status: STABLE
        node_type: output
        description: >
            Logstash node to send indicators message to a local logstash instance on
            port 5514
        class: minemeld.ft.logstash.LogstashOutput
        config:
            logstash_host: 127.0.0.1
            logstash_port: 5514

    dagPusher:
        development_status: STABLE
        node_type: output
        description: >
            Push IP unicast indicators to PAN-OS devices via DAG, typically connected
            to a syslog node
        class: minemeld.ft.dag.DagPusher

    feedLCRedWithValue:
        development_status: STABLE
        node_type: output
        description: >
            EBL for low confidence indicators (<50) and share level red, with value
        class: minemeld.ft.redis.RedisSet
        config:
            store_value: true
            infilters:
                - name: accept withdraws
                  conditions:
                    - __method == 'withdraw'
                  actions:
                    - accept
                - name: accept confidence < 50 and share level red
                  conditions:
                    - confidence < 50
                    - share_level == 'red'
                  actions:
                    - accept
                - name: drop all
                  actions:
                    - drop

    feedMCRedWithValue:
        development_status: STABLE
        node_type: output
        description: >
            EBL for medium confidence indicators (>=50,<75) and share level red, with value
        class: minemeld.ft.redis.RedisSet
        config:
            store_value: true
            infilters:
                - name: accept withdraws
                  conditions:
                    - __method == 'withdraw'
                  actions:
                    - accept
                - name: accept confidence < 50 and share level red
                  conditions:
                    - confidence >= 50
                    - confidence < 75
                    - share_level == 'red'
                  actions:
                    - accept
                - name: drop all
                  actions:
                    - drop

    feedHCRedWithValue:
        development_status: STABLE
        node_type: output
        description: >
            EBL for high confidence indicators (>75) and share level red, with value
        class: minemeld.ft.redis.RedisSet
        config:
            store_value: true
            infilters:
                - name: accept withdraws
                  conditions:
                    - __method == 'withdraw'
                  actions:
                    - accept
                - name: accept confidence > 75 and share level red
                  conditions:
                    - confidence > 75
                    - share_level == 'red'
                  actions:
                    - accept
                - name: drop all
                  actions:
                    - drop

    listIPv4Generic:
        development_status: EXPERIMENTAL
        node_type: miner
        description: >
            list of IPv4 addresses. Use a name starting with "wl" to create a whitelist for
            an aggregator
        class: minemeld.ft.local.YamlIPv4FT
        config:
            interval: 53
            age_out:
                default: null
                sudden_death: true
                interval: 67
            attributes:
                confidence: 100
                share_level: red
