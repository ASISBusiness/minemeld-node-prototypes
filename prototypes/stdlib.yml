author: lmori
description: Library of prototypes for commonly used nodes

prototypes:
    aggregatorURL:
        development_status: STABLE
        description: Aggregator for URL indicators
        class: minemeld.ft.op.AggregateFT
        config:
            infilters:
                - name: accept withdraws
                  conditions:
                    - __method == 'withdraw'
                  actions:
                    - accept
                - name: accept URL
                  conditions:
                    - type == 'URL'
                  actions:
                    - accept
                - name: drop all
                  actions:
                    - drop

    aggregatorIPv4Generic:
        development_status: STABLE
        description: Generic Aggregator for IPv4 indicators
        class: minemeld.ft.ipop.AggregateIPv4FT
        config:
            infilters:
                - name: accept withdraws
                  conditions:
                    - __method == 'withdraw'
                  actions:
                    - accept
                - name: accept IPv4
                  conditions:
                    - type == 'IPv4'
                  actions:
                    - accept
                - name: drop all
                  actions:
                    - drop

    aggregatorIPv4Inbound:
        development_status: STABLE
        description: Aggregator for inbound IPv4 indicators
        class: minemeld.ft.ipop.AggregateIPv4FT
        config:
            infilters:
                - name: accept withdraws
                  conditions:
                    - __method == 'withdraw'
                  actions:
                    - accept
                - name: accept inbound IPv4
                  conditions:
                    - type == 'IPv4'
                    - direction == 'inbound'
                  actions:
                    - accept
                - name: accept generic IPv4
                    - type == 'IPv4'
                    - direction == null
                  actions:
                    - accept
                - name: drop all
                  actions:
                    - drop

    aggregatorIPv4Outbound:
        development_status: STABLE
        description: Aggregator for outbound IPv4 indicators
        class: minemeld.ft.ipop.AggregateIPv4FT
        config:
            infilters:
                - name: accept withdraws
                  conditions:
                    - __method == 'withdraw'
                  actions:
                    - accept
                - name: accept inbound IPv4
                  conditions:
                    - type == 'IPv4'
                    - direction == 'outbound'
                  actions:
                    - accept
                - name: accept generic IPv4
                    - type == 'IPv4'
                    - direction == null
                  actions:
                    - accept
                - name: drop all
                  actions:
                    - drop

    feedLCGreen:
        development_status: STABLE
        description: >
            EBL for low confidence indicators (<50) and share level green
        class: minemeld.ft.redis.RedisSet
        config:
            infilters:
                - name: accept withdraws
                  conditions:
                    - __method == 'withdraw'
                  actions:
                    - accept
                - name: accept confidence < 50 and share level green
                  conditions:
                    - confidence < 50
                    - share_level == 'green'
                  actions:
                    - accept
                - name: drop all
                  actions:
                    - drop

    feedMCGreen:
        development_status: STABLE
        description: >
            EBL for medium confidence indicators (>=50,<75) and share level green
        class: minemeld.ft.redis.RedisSet
        config:
            infilters:
                - name: accept withdraws
                  conditions:
                    - __method == 'withdraw'
                  actions:
                    - accept
                - name: accept confidence < 50 and share level green
                  conditions:
                    - confidence >= 50
                    - confidence < 75
                    - share_level == 'green'
                  actions:
                    - accept
                - name: drop all
                  actions:
                    - drop

    feedHCGreen:
        development_status: STABLE
        description: >
            EBL for high confidence indicators (>75) and share level green, with value
        class: minemeld.ft.redis.RedisSet
        config:
            infilters:
                - name: accept withdraws
                  conditions:
                    - __method == 'withdraw'
                  actions:
                    - accept
                - name: accept confidence > 75 and share level green
                  conditions:
                    - confidence > 75
                    - share_level == 'green'
                  actions:
                    - accept
                - name: drop all
                  actions:
                    - drop

    feedLCGreenWithValue:
        development_status: STABLE
        description: >
            EBL for low confidence indicators (<50) and share level green, with value
        class: minemeld.ft.redis.RedisSet
        config:
            store_value: true
            infilters:
                - name: accept withdraws
                  conditions:
                    - __method == 'withdraw'
                  actions:
                    - accept
                - name: accept confidence < 50 and share level green
                  conditions:
                    - confidence < 50
                    - share_level == 'green'
                  actions:
                    - accept
                - name: drop all
                  actions:
                    - drop

    feedMCGreenWithValue:
        development_status: STABLE
        description: >
            EBL for medium confidence indicators (>=50,<75) and share level green, with value
        class: minemeld.ft.redis.RedisSet
        config:
            store_value: true
            infilters:
                - name: accept withdraws
                  conditions:
                    - __method == 'withdraw'
                  actions:
                    - accept
                - name: accept confidence < 50 and share level green
                  conditions:
                    - confidence >= 50
                    - confidence < 75
                    - share_level == 'green'
                  actions:
                    - accept
                - name: drop all
                  actions:
                    - drop

    feedHCGreenWithValue:
        development_status: STABLE
        description: >
            EBL for high confidence indicators (>75) and share level green, with value
        class: minemeld.ft.redis.RedisSet
        config:
            store_value: true
            infilters:
                - name: accept withdraws
                  conditions:
                    - __method == 'withdraw'
                  actions:
                    - accept
                - name: accept confidence > 75 and share level green
                  conditions:
                    - confidence > 75
                    - share_level == 'green'
                  actions:
                    - accept
                - name: drop all
                  actions:
                    - drop

    localSyslog:
        development_status: STABLE
        description: >
            Syslog node connection to the local syslog server to receive PAN-OS logs
        class: minemeld.ft.syslog.SyslogMatcher

    localLogStash:
        development_status: STABLE
        description: >
            Logstash node to send indicators message to a local logstash instance on
            port 5514
        class: minemeld.ft.logstash.LogstashOutput
        config:
            logstash_host: 127.0.0.1
            logstash_port: 5514

    dagPusher:
        development_status: STABLE
        description: >
            Push IP unicast indicators to PAN-OS devices via DAG, typically connected
            to a syslog node
        class: minemeld.ft.dag.DagPusher
